<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Micoé¡§å•åœ˜éšŠå°ˆå±¬ ç¿Šèµ·å¹¸ç¦ç¾éº—æˆç¦</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:Microsoft JhengHei,sans-serif;background:#f5f5f5;padding:10px}

    .calc{max-width:420px;margin:0 auto;background:#fff;border-radius:20px;overflow:hidden;box-shadow:0 15px 40px rgba(0,0,0,.15)}
    .title{background:linear-gradient(90deg,#37474f,#607d8b);color:#fff;text-align:center;padding:20px 16px}
    .title h1{font-size:18px;margin:0}
    .title p{font-size:12px;margin-top:4px}
    .content{padding:18px 14px}

    .section{margin-bottom:18px}
    .section-title{font-size:15px;font-weight:bold;color:#333;margin-bottom:8px;border-left:4px solid #37474f;padding-left:6px}

    select,input{width:100%;padding:10px;border:2px solid #e1e8ed;border-radius:10px;font-size:14px;margin-bottom:8px;transition:all .2s}
    select:focus,input:focus{outline:none;border-color:#37474f;box-shadow:0 0 0 3px rgba(55,71,79,.1)}

    .tabs{display:flex;flex-wrap:wrap;margin-bottom:10px;border-radius:10px;overflow:hidden;border:1px solid #ddd}
    .tab-btn{flex:1 1 33%;padding:6px 4px;font-size:12px;border:none;border-right:1px solid:#ddd;border-bottom:1px solid:#ddd;background:#f5f5f5;cursor:pointer}
    .tab-btn:nth-child(3n){border-right:none}
    .tab-btn.active{background:#37474f;color:#fff;font-weight:bold}
    .tab-content{display:none}
    .tab-content.active{display:block}

    .product-row{display:flex;align-items:center;padding:8px 8px;background:#f8f9fa;border-radius:10px;margin-bottom:6px;font-size:13px}
    .product-info{flex:1}
    .product-name{font-weight:bold;color:#333}
    .product-pv{font-size:11px;color:#666;margin-top:2px}
    .qty{width:55px;padding:6px;font-size:14px;border:2px solid:#ddd;border-radius:8px;text-align:center;margin-left:8px;background:#fff}

    .summary{background:#e3f2fd;padding:10px;border-radius:12px;margin-bottom:10px;font-size:13px}
    .summary-row{display:flex;justify-content:space-between;font-weight:bold;margin-bottom:4px}
    .summary-value{color:#1976d2;font-size:15px}

    .checkout-box{background:#fff3e0;border-radius:12px;border:2px solid:#ff9800;padding:12px;margin-top:8px;font-size:12px}
    .checkout-title{text-align:center;font-size:15px;font-weight:bold;color:#e65100;margin-bottom:6px}
    .final-pay{text-align:center;font-size:19px;font-weight:bold;color:#d32f2f;margin:8px 0}

    .order-wrapper{max-width:1000px;margin:20px auto 8px auto;background:#fff;border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,.12);padding:14px}
    .order-header{font-size:16px;font-weight:bold;border-bottom:3px solid:#003366;padding-bottom:6px;margin-bottom:8px}
    .order-date{float:right;font-size:12px;color:#666}
    table{width:100%;border-collapse:collapse;font-size:12px;text-align:center}
    th,td{padding:5px 3px}
    thead tr{background:#f5f5f5;border-bottom:2px solid:#ccc}
    th{border-right:1px solid:#ddd}
    tbody td{border-top:1px solid:#eee;border-right:1px solid:#eee}
    tbody td:last-child{border-right:none}
    .order-footer-row{background:#f1f1f7;font-weight:bold}

    .order-bottom{display:flex;align-items:center;margin-top:10px;gap:8px}
    .name-box{flex:1;display:flex;align-items:center;border:1px solid:#ccc;border-radius:4px;overflow:hidden}
    .name-label{background:#f5f5f5;padding:6px 8px;border-right:1px solid:#ccc;font-size:12px}
    .name-input{flex:1;border:none;padding:6px 8px;font-size:12px;outline:none}
    .btn-copy{border:1px solid:#ccc;background:#fff;padding:6px 10px;border-radius:4px;cursor:pointer;font-size:12px}
  </style>
</head>
<body>
  <div class="calc">
    <div class="title">
      <h1>Micoé¡§å•åœ˜éšŠå°ˆå±¬ ç¿Šèµ·å¹¸ç¦ç¾éº—æˆç¦</h1>
      <p></p>
    </div>
    <div class="content">
      <!-- éšç´š -->
      <div class="section">
        <div class="section-title">ğŸ‘‘ ç›®å‰éšç´š</div>
        <select id="rank">
          <option value="0.00">æœƒå“¡ (0%)</option>
          <option value="0.25" selected>å°ˆå“¡ (25%)</option>
          <option value="0.30">ä¸»ä»» (30%)</option>
          <option value="0.35">ç¶“ç† (35%)</option>
          <option value="0.37">å¯¶çŸ³éš (37%)</option>
          <option value="0.38">é‘½çŸ³éš (38%)</option>
          <option value="0.39">é‡‘é‘½éš (39%)</option>
          <option value="0.40">é¡§å•éš (40%)</option>
        </select>
      </div>

      <!-- Tabs -->
      <div class="section">
        <div class="section-title">ğŸ§´ è«‹é¸æ“‡ç³»åˆ—</div>
        <div class="tabs">
          <button class="tab-btn active" data-tab="tab-basic">å…¨æ–¹ä½æ¥µè‡´ä¿é¤Š</button>
          <button class="tab-btn" data-tab="tab-repair">é«˜æ©Ÿèƒ½ä¿®è­·</button>
          <button class="tab-btn" data-tab="tab-sun">UV é˜²æ›¬</button>
          <button class="tab-btn" data-tab="tab-acne">æœ‰æ„ŸæŠ—ç—˜</button>
          <button class="tab-btn" data-tab="tab-essence">ç²¾èƒä¿é¤Š</button>
          <button class="tab-btn" data-tab="tab-body">ç¾é«”è­·ç†</button>
          <button class="tab-btn" data-tab="tab-health">ä¿å¥ç‡Ÿé¤Š</button>
        </div>

        <!-- å…¨æ–¹ä½æ¥µè‡´ä¿é¤Šç³»åˆ—ï¼šå…¨éƒ¨å“é … -->
        <div id="tab-basic" class="tab-content active">
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">æ·¨å¦ç²¾è¯å‡è† </div>
              <div class="product-pv">150ml Â· 1,995 / 1,300PV Â· C0</div>
            </div>
            <input type="number" class="qty" id="qty-C0" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">1A é›™é‡æ½”é¡éœ²</div>
              <div class="product-pv">120ml Â· 1,995 / 1,700PV</div>
            </div>
            <input type="number" class="qty" id="qty-1A" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">2A å‡è¡¡æ½¤è†šéœ²</div>
              <div class="product-pv">120ml Â· 1,995 / 1,700PV</div>
            </div>
            <input type="number" class="qty" id="qty-2A" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">3 å¤šæ•ˆæ™¶æ½¤çœ¼éœœ</div>
              <div class="product-pv">30ml Â· 3,990 / 3,500PV</div>
            </div>
            <input type="number" class="qty" id="qty-3" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">4 å«©ç™½èè¯éœœ</div>
              <div class="product-pv">50ml Â· 4,200 / 3,600PV</div>
            </div>
            <input type="number" class="qty" id="qty-4" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">5A äº®é¡èª¿ç†éœœ</div>
              <div class="product-pv">50ml Â· 4,200 / 3,600PV</div>
            </div>
            <input type="number" class="qty" id="qty-5A" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">5B äº®é¡èª¿ç†éœœ</div>
              <div class="product-pv">50ml Â· 4,200 / 3,600PV</div>
            </div>
            <input type="number" class="qty" id="qty-5B" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">7 æ™¶ç…¥æ´»è†šéœœ</div>
              <div class="product-pv">30ml Â· 2,500 / 1,800PV</div>
            </div>
            <input type="number" class="qty" id="qty-7" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">8 è³¦æ´»ç²¾è¯éœœ</div>
              <div class="product-pv">50ml Â· 3,990 / 3,500PV</div>
            </div>
            <input type="number" class="qty" id="qty-8" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">9A æŸ”æ½¤ä¿æ¿•éœœ</div>
              <div class="product-pv">50ml Â· 2,990 / 2,100PV</div>
            </div>
            <input type="number" class="qty" id="qty-9A" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">9B æŸ”æ½¤ä¿æ¿•éœœâ€‘B</div>
              <div class="product-pv">50ml Â· 2,990 / 2,100PV</div>
            </div>
            <input type="number" class="qty" id="qty-9B" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">Q10 ç¾è†šç…¥é‡‡éœœ</div>
              <div class="product-pv">30ml Â· 3,190 / 2,400PV</div>
            </div>
            <input type="number" class="qty" id="qty-Q10" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">4 å«©ç™½èè¯éœœ (s)</div>
              <div class="product-pv">30ml Â· 2,650 / 2,100PV</div>
            </div>
            <input type="number" class="qty" id="qty-4s" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">5A äº®é¡èª¿ç†éœœ (s)</div>
              <div class="product-pv">30ml Â· 2,650 / 2,100PV</div>
            </div>
            <input type="number" class="qty" id="qty-5As" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">8 è³¦æ´»ç²¾è¯éœœ (s)</div>
              <div class="product-pv">30ml Â· 2,450 / 1,900PV</div>
            </div>
            <input type="number" class="qty" id="qty-8s" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">9A æŸ”æ½¤ä¿æ¿•éœœ (s)</div>
              <div class="product-pv">30ml Â· 2,090 / 1,100PV</div>
            </div>
            <input type="number" class="qty" id="qty-9As" min="0" value="0">
          </div>
        </div>

        <!-- é«˜æ©Ÿèƒ½ä¿®è­·ç³»åˆ— -->
        <div id="tab-repair" class="tab-content">
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">ç¶­ä»–å‘½Cç¾ç™½ç²‰(100g)</div>
              <div class="product-pv">100g Â· 32,900 / 27,000PV</div>
            </div>
            <input type="number" class="qty" id="qty-VC100" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">ç¶­ä»–å‘½Cç¾ç™½ç²‰(10g)</div>
              <div class="product-pv">10g Â· 3,990 / 3,500PV</div>
            </div>
            <input type="number" class="qty" id="qty-VC10" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">ç¬æ•ˆé–æ°´ä¿®è­·ç²¾è¯(ç´«)</div>
              <div class="product-pv">30ml Â· 3,090 / 2,200PV</div>
            </div>
            <input type="number" class="qty" id="qty-P1" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">ç¬æ•ˆé›™èƒä¿®è­·ç²¾è¯(æ¡ƒ)</div>
              <div class="product-pv">30ml Â· 3,090 / 2,200PV</div>
            </div>
            <input type="number" class="qty" id="qty-P2" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">è¶…æ°´æ½¤ç·Šç·»ä¿æ¿•å®‰ç“¶ NEW</div>
              <div class="product-pv">30ml Â· 2,890 / 2,000PV</div>
            </div>
            <input type="number" class="qty" id="qty-AMP" min="0" value="0">
          </div>
        </div>

        <!-- UV é˜²æ›¬ç³»åˆ— -->
        <div id="tab-sun" class="tab-content">
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">6A é«˜æ•ˆé–æ°´é˜²æ›¬éœœ</div>
              <div class="product-pv">50ml Â· 3,990 / 3,500PV</div>
            </div>
            <input type="number" class="qty" id="qty-6A" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">6As é«˜æ•ˆé–æ°´é˜²æ›¬éœœ (s)</div>
              <div class="product-pv">30ml Â· 2,450 / 1,900PV</div>
            </div>
            <input type="number" class="qty" id="qty-6As" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">6B æ°´å‡æ½¤ç™½é˜²æ›¬éœœ</div>
              <div class="product-pv">50ml Â· 3,990 / 3,500PV</div>
            </div>
            <input type="number" class="qty" id="qty-6B" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">6C å®Œç¾è¼•é€é˜²æ›¬éœœ</div>
              <div class="product-pv">30ml Â· 1,990 / 1,500PV</div>
            </div>
            <input type="number" class="qty" id="qty-6C" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">6D æ¥µè‡´å…‰æ„Ÿé˜²æ›¬éœœ</div>
              <div class="product-pv">30ml Â· 2,890 / 2,000PV</div>
            </div>
            <input type="number" class="qty" id="qty-6D" min="0" value="0">
          </div>
        </div>

        <!-- æœ‰æ„ŸæŠ—ç—˜ç³»åˆ— -->
        <div id="tab-acne" class="tab-content">
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">1B æŠ—ç—˜æ½”é¡å‡éœ² NEW</div>
              <div class="product-pv">120ml Â· 1,990 / 1,500PV</div>
            </div>
            <input type="number" class="qty" id="qty-1B" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">2B æŠ—ç—˜èª¿ç†æ™¶éœ² NEW</div>
              <div class="product-pv">120ml Â· 1,990 / 1,500PV</div>
            </div>
            <input type="number" class="qty" id="qty-2B" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">è¶…é€²åŒ–æŠ—ç—˜æ´»æ€§å®‰ç“¶ NEW</div>
              <div class="product-pv">30ml Â· 2,890 / 2,000PV</div>
            </div>
            <input type="number" class="qty" id="qty-AC" min="0" value="0">
          </div>
        </div>

        <!-- ç²¾èƒä¿é¤Šç³»åˆ— -->
        <div id="tab-essence" class="tab-content">
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">ä¿æ¿•ä¿®è­·ç”Ÿç‰©çº–ç¶­é¢è†œ</div>
              <div class="product-pv">5pcs/ç›’ Â· 2,940 / 2,400PV</div>
            </div>
            <input type="number" class="qty" id="qty-M1" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">çç äº®ç™½ç”Ÿç‰©çº–ç¶­é¢è†œ</div>
              <div class="product-pv">5pcs/ç›’ Â· 2,940 / 2,400PV</div>
            </div>
            <input type="number" class="qty" id="qty-M2" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">ç”Ÿéº—å¸æ²¹é¢ç´™</div>
              <div class="product-pv">10ç›’/çµ„ Â· 450 / 300PV</div>
            </div>
            <input type="number" class="qty" id="qty-O1" min="0" value="0">
          </div>
        </div>

        <!-- ç¾é«”è­·ç†ç³»åˆ— -->
        <div id="tab-body" class="tab-content">
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">ä¿æ¿•ä¿®è­·èº«é«”ä¹³</div>
              <div class="product-pv">200ml Â· 1,990 / 1,400PV</div>
            </div>
            <input type="number" class="qty" id="qty-B1" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">å«©ç™½æ·¨ç—˜èº«é«”ä¹³ NEW</div>
              <div class="product-pv">200ml Â· 1,990 / 1,400PV</div>
            </div>
            <input type="number" class="qty" id="qty-B2" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">æ¥µæ•ˆæ°´æ½¤ç‰æ‰‹éœœ NEW</div>
              <div class="product-pv">30ml Â· 450 / 300PV</div>
            </div>
            <input type="number" class="qty" id="qty-B3" min="0" value="0">
          </div>
        </div>

        <!-- ä¿å¥ç‡Ÿé¤Šé£Ÿå“ -->
        <div id="tab-health" class="tab-content">
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">å„ªé©éº—è† å›Šé£Ÿå“</div>
              <div class="product-pv">60é¡†/ç“¶ Â· 2,280 / 1,300PV</div>
            </div>
            <input type="number" class="qty" id="qty-N1" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">æ¾èŠ¯éº—è† å›Šé£Ÿå“</div>
              <div class="product-pv">60é¡†/ç“¶ Â· 3,580 / 2,400PV</div>
            </div>
            <input type="number" class="qty" id="qty-N2" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">ç¾é¡éº—è† å›Šé£Ÿå“</div>
              <div class="product-pv">60é¡†/ç“¶ Â· 2,980 / 1,600PV</div>
            </div>
            <input type="number" class="qty" id="qty-N3" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">ç†Šè­·éº—è† å›Šé£Ÿå“</div>
              <div class="product-pv">60é¡†/ç“¶ Â· 2,980 / 1,600PV</div>
            </div>
            <input type="number" class="qty" id="qty-N4" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">æ•æ·éº—è† å›Šé£Ÿå“</div>
              <div class="product-pv">60é¡†/ç“¶ Â· 2,380 / 1,400PV</div>
            </div>
            <input type="number" class="qty" id="qty-N5" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">èŠ·ç³–éº—è† å›Šé£Ÿå“ NEW</div>
              <div class="product-pv">60é¡†/ç“¶ Â· 3,280 / 1,900PV</div>
            </div>
            <input type="number" class="qty" id="qty-N6" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">èˆ’éº©éº—é«˜çº–ç‡•éº¥éº© NEW</div>
              <div class="product-pv">30åŒ…/ç›’ Â· 1,880 / 1,100PV</div>
            </div>
            <input type="number" class="qty" id="qty-N7" min="0" value="0">
          </div>
          <div class="product-row">
            <div class="product-info">
              <div class="product-name">å…ç›Šéº—æ©Ÿèƒ½ç›Šç”ŸèŒ NEW</div>
              <div class="product-pv">30åŒ…/ç›’ Â· 2,280 / 1,300PV</div>
            </div>
            <input type="number" class="qty" id="qty-N8" min="0" value="0">
          </div>
        </div>
      </div>

      <!-- ç¸½çµ -->
      <div class="summary">
        <div class="summary-row">
          <span>ç¸½é‡‘é¡</span>
          <span class="summary-value" id="totalAmount">NT$0</span>
        </div>
        <div class="summary-row">
          <span>ç¸½ PV å€¼</span>
          <span class="summary-value" id="totalPV">0 PV</span>
        </div>
      </div>
    </div>
  </div>

  <!-- è¨‚å–®æ˜ç´° -->
  <div class="order-wrapper">
    <div class="order-header">
      è¨‚å–®æ˜ç´°
      <span class="order-date" id="orderDate"></span>
    </div>
    <div style="overflow-x:auto;">
      <table>
        <thead>
          <tr>
            <th>ç”¢å“åç¨±</th>
            <th>å”®åƒ¹</th>
            <th>PVå€¼</th>
            <th>ä»£è™Ÿ</th>
            <th>æ•¸é‡</th>
            <th>é‡‘é¡</th>
            <th>PVå€¼</th>
          </tr>
        </thead>
        <tbody id="orderBody"></tbody>
        <tfoot>
          <tr class="order-footer-row">
            <td style="text-align:left;padding-left:8px;">ç¸½è¨ˆ</td>
            <td></td><td></td><td></td>
            <td id="sumQty">0</td>
            <td id="sumAmount">0</td>
            <td id="sumPV">0</td>
          </tr>
        </tfoot>
      </table>
    </div>

    <div class="order-bottom">
      <div class="name-box">
        <span class="name-label">å§“åï¼š</span>
        <input id="customerName" class="name-input" type="text" placeholder="è¼¸å…¥å§“å">
      </div>
      <button class="btn-copy" onclick="copyOrder()">ğŸ“‹ è¤‡è£½</button>
    </div>
  </div>

  <script>
    const products = [
      { code: 'C0',  name: 'æ·¨å¦ç²¾è¯å‡è† ',        unit: '150ml/ç“¶', price: 1995, pv: 1300 },
      { code: '1A',  name: 'é›™é‡æ½”é¡éœ²',          unit: '120ml/ç“¶', price: 1995, pv: 1700 },
      { code: '2A',  name: 'å‡è¡¡æ½¤è†šéœ²',          unit: '120ml/ç“¶', price: 1995, pv: 1700 },
      { code: '3',   name: 'å¤šæ•ˆæ™¶æ½¤çœ¼éœœ',        unit: '30ml/ç“¶',  price: 3990, pv: 3500 },
      { code: '4',   name: 'å«©ç™½èè¯éœœ',          unit: '50ml/ç“¶',  price: 4200, pv: 3600 },
      { code: '5A',  name: 'äº®é¡èª¿ç†éœœ',          unit: '50ml/ç“¶',  price: 4200, pv: 3600 },
      { code: '5B',  name: 'äº®é¡èª¿ç†éœœ',          unit: '50ml/ç“¶',  price: 4200, pv: 3600 },
      { code: '7',   name: 'æ™¶ç…¥æ´»è†šéœœ',          unit: '30ml/ç“¶',  price: 2500, pv: 1800 },
      { code: '8',   name: 'è³¦æ´»ç²¾è¯éœœ',          unit: '50ml/ç“¶',  price: 3990, pv: 3500 },
      { code: '9A',  name: 'æŸ”æ½¤ä¿æ¿•éœœ',          unit: '50ml/ç“¶',  price: 2990, pv: 2100 },
      { code: '9B',  name: 'æŸ”æ½¤ä¿æ¿•éœœâ€‘B',        unit: '50ml/ç“¶',  price: 2990, pv: 2100 },
      { code: 'Q10', name: 'ç¾è†šç…¥é‡‡éœœ',          unit: '30ml/ç“¶',  price: 3190, pv: 2400 },
      { code: '4s',  name: 'å«©ç™½èè¯éœœ (s)',      unit: '30ml/ç“¶',  price: 2650, pv: 2100 },
      { code: '5As', name: 'äº®é¡èª¿ç†éœœ (s)',      unit: '30ml/ç“¶',  price: 2650, pv: 2100 },
      { code: '8s',  name: 'è³¦æ´»ç²¾è¯éœœ (s)',      unit: '30ml/ç“¶',  price: 2450, pv: 1900 },
      { code: '9As', name: 'æŸ”æ½¤ä¿æ¿•éœœ (s)',      unit: '30ml/ç“¶',  price: 2090, pv: 1100 },

      { code: 'VC100',  name: 'ç¶­ä»–å‘½Cç¾ç™½ç²‰(100g) åŠ è´ˆ10g 1ç“¶', unit: '100g/ç“¶', price: 32900, pv: 27000 },
      { code: 'VC10',   name: 'ç¶­ä»–å‘½Cç¾ç™½ç²‰(10g)',              unit: '10g/ç“¶',  price: 3990,  pv: 3500 },
      { code: 'P1',     name: 'ç¬æ•ˆé–æ°´ä¿®è­·ç²¾è¯(ç´«)',            unit: '30ml/ç“¶', price: 3090,  pv: 2200 },
      { code: 'P2',     name: 'ç¬æ•ˆé›™èƒä¿®è­·ç²¾è¯(æ¡ƒ)',            unit: '30ml/ç“¶', price: 3090,  pv: 2200 },
      { code: 'AMP',    name: 'è¶…æ°´æ½¤ç·Šç·»ä¿æ¿•å®‰ç“¶ NEW',          unit: '30ml/ç“¶', price: 2890,  pv: 2000 },

      { code: '6A',  name: 'é«˜æ•ˆé–æ°´é˜²æ›¬éœœ',          unit: '50ml/ç“¶', price: 3990, pv: 3500 },
      { code: '6As', name: 'é«˜æ•ˆé–æ°´é˜²æ›¬éœœ (s)',      unit: '30ml/ç“¶', price: 2450, pv: 1900 },
      { code: '6B',  name: 'æ°´å‡æ½¤ç™½é˜²æ›¬éœœ',          unit: '50ml/ç“¶', price: 3990, pv: 3500 },
      { code: '6C',  name: 'å®Œç¾è¼•é€é˜²æ›¬éœœ',          unit: '30ml/ç“¶', price: 1990, pv: 1500 },
      { code: '6D',  name: 'æ¥µè‡´å…‰æ„Ÿé˜²æ›¬éœœ',          unit: '30ml/ç“¶', price: 2890, pv: 2000 },

      { code: '1B', name: 'æŠ—ç—˜æ½”é¡å‡éœ² NEW',          unit: '120ml/ç“¶', price: 1990, pv: 1500 },
      { code: '2B', name: 'æŠ—ç—˜èª¿ç†æ™¶éœ² NEW',          unit: '120ml/ç“¶', price: 1990, pv: 1500 },
      { code: 'AC', name: 'è¶…é€²åŒ–æŠ—ç—˜æ´»æ€§å®‰ç“¶ NEW',    unit: '30ml/ç“¶',  price: 2890, pv: 2000 },

      { code: 'M1', name: 'ä¿æ¿•ä¿®è­·ç”Ÿç‰©çº–ç¶­é¢è†œ',      unit: '5pcs/ç›’',  price: 2940, pv: 2400 },
      { code: 'M2', name: 'çç äº®ç™½ç”Ÿç‰©çº–ç¶­é¢è†œ',      unit: '5pcs/ç›’',  price: 2940, pv: 2400 },
      { code: 'O1', name: 'ç”Ÿéº—å¸æ²¹é¢ç´™',              unit: '10ç›’/çµ„',  price: 450,  pv: 300 },

      { code: 'B1', name: 'ä¿æ¿•ä¿®è­·èº«é«”ä¹³',            unit: '200ml/ç“¶', price: 1990, pv: 1400 },
      { code: 'B2', name: 'å«©ç™½æ·¨ç—˜èº«é«”ä¹³ NEW',        unit: '200ml/ç“¶', price: 1990, pv: 1400 },
      { code: 'B3', name: 'æ¥µæ•ˆæ°´æ½¤ç‰æ‰‹éœœ NEW',        unit: '30ml/ç“¶',  price: 450,  pv: 300 },

      { code: 'N1', name: 'å„ªé©éº—è† å›Šé£Ÿå“',            unit: '60é¡†/ç“¶',  price: 2280, pv: 1300 },
      { code: 'N2', name: 'æ¾èŠ¯éº—è† å›Šé£Ÿå“',            unit: '60é¡†/ç“¶',  price: 3580, pv: 2400 },
      { code: 'N3', name: 'ç¾é¡éº—è† å›Šé£Ÿå“',            unit: '60é¡†/ç“¶',  price: 2980, pv: 1600 },
      { code: 'N4', name: 'ç†Šè­·éº—è† å›Šé£Ÿå“',            unit: '60é¡†/ç“¶',  price: 2980, pv: 1600 },
      { code: 'N5', name: 'æ•æ·éº—è† å›Šé£Ÿå“',            unit: '60é¡†/ç“¶',  price: 2380, pv: 1400 },
      { code: 'N6', name: 'èŠ·ç³–éº—è† å›Šé£Ÿå“ NEW',        unit: '60é¡†/ç“¶',  price: 3280, pv: 1900 },
      { code: 'N7', name: 'èˆ’éº©éº—é«˜çº–ç‡•éº¥éº© NEW',      unit: '30åŒ…/ç›’',  price: 1880, pv: 1100 },
      { code: 'N8', name: 'å…ç›Šéº—æ©Ÿèƒ½ç›Šç”ŸèŒ NEW',      unit: '30åŒ…/ç›’',  price: 2280, pv: 1300 },

      { code: 'JOIN',  name: 'å…¥æœƒè²»',                 unit: '',         price: 1000, pv: 0 },
      { code: 'RENEW', name: 'çºŒç´„è²»',                 unit: '',         price: 500,  pv: 0 }
    ];

    const codeToInput = {
      'C0':'qty-C0','1A':'qty-1A','2A':'qty-2A','3':'qty-3','4':'qty-4',
      '5A':'qty-5A','5B':'qty-5B','7':'qty-7','8':'qty-8','9A':'qty-9A',
      '9B':'qty-9B','Q10':'qty-Q10','4s':'qty-4s','5As':'qty-5As',
      '8s':'qty-8s','9As':'qty-9As',
      'VC100':'qty-VC100','VC10':'qty-VC10','P1':'qty-P1','P2':'qty-P2','AMP':'qty-AMP',
      '6A':'qty-6A','6As':'qty-6As','6B':'qty-6B','6C':'qty-6C','6D':'qty-6D',
      '1B':'qty-1B','2B':'qty-2B','AC':'qty-AC',
      'M1':'qty-M1','M2':'qty-M2','O1':'qty-O1',
      'B1':'qty-B1','B2':'qty-B2','B3':'qty-B3',
      'N1':'qty-N1','N2':'qty-N2','N3':'qty-N3','N4':'qty-N4',
      'N5':'qty-N5','N6':'qty-N6','N7':'qty-N7','N8':'qty-N8'
    };

    function calculate(){
      let amt=0, pv=0, qtySum=0;
      Object.keys(codeToInput).forEach(code=>{
        const p = products.find(x=>x.code===code);
        if(!p) return;
        const el = document.getElementById(codeToInput[code]);
        if(!el) return;
        const q = parseInt(el.value) || 0;
        amt += q * p.price;
        pv  += q * p.pv;
        qtySum += q;
      });

      document.getElementById('totalAmount').textContent = 'NT$' + amt.toLocaleString();
      document.getElementById('totalPV').textContent     = pv.toLocaleString() + ' PV';
      document.getElementById('sumQty').textContent      = qtySum;
      document.getElementById('sumAmount').textContent   = amt.toLocaleString();
      document.getElementById('sumPV').textContent       = pv.toLocaleString();

      renderOrderTable();
    }

    function renderOrderTable(){
      const tbody=document.getElementById('orderBody');
      tbody.innerHTML='';
      Object.keys(codeToInput).forEach(code=>{
        const p = products.find(x=>x.code===code);
        if(!p) return;
        const el = document.getElementById(codeToInput[code]);
        if(!el) return;
        const q = parseInt(el.value) || 0;
        const lineAmt = q * p.price;
        const linePV  = q * p.pv;
        const tr=document.createElement('tr');
        tr.innerHTML=`
          <td style="text-align:left;">${p.name}</td>
          <td>${p.price.toLocaleString()}</td>
          <td>${p.pv.toLocaleString()}</td>
          <td>${p.code}</td>
          <td style="background:${q>0?'#c8f7c5':'transparent'};">${q}</td>
          <td style="background:${lineAmt>0?'#fff9c4':'transparent'};">${lineAmt>0?lineAmt.toLocaleString():'0'}</td>
          <td>${linePV>0?linePV.toLocaleString():'0'}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function copyOrder(){
      const name = document.getElementById('customerName').value || 'ï¼ˆæœªå¡«å§“åï¼‰';
      calculate();

      const sumQty    = document.getElementById('sumQty').textContent || '0';
      const sumAmount = document.getElementById('sumAmount').textContent || '0';
      const sumPV     = document.getElementById('sumPV').textContent || '0';

      let text = `ã€è¨‚å–®æ˜ç´°ã€‘\nå§“åï¼š${name}\n\n`;
      text += `å“å / å”®åƒ¹ / PV / æ•¸é‡ / é‡‘é¡ / PV\n`;

      Object.keys(codeToInput).forEach(code=>{
        const p = products.find(x=>x.code===code);
        if(!p) return;
        const el = document.getElementById(codeToInput[code]);
        if(!el) return;
        const q = parseInt(el.value) || 0;
        if(q>0){
          const lineAmt = q * p.price;
          const linePV  = q * p.pv;
          text += `${p.name} / ${p.price} / ${p.pv} / ${q} / ${lineAmt} / ${linePV}\n`;
        }
      });

      text += `\nã€ç¸½è¨ˆã€‘ æ•¸é‡ï¼š${sumQty} / é‡‘é¡ï¼š${sumAmount} / PVï¼š${sumPV}\n`;

      navigator.clipboard.writeText(text).then(()=>{
        alert('è¨‚å–® + ç¸½è¨ˆ å·²è¤‡è£½ï¼Œå¯è²¼åˆ° Line / è¨˜äº‹æœ¬ã€‚');
      });
    }

    document.querySelectorAll('.tab-btn').forEach(btn=>{
      btn.addEventListener('click',()=>{
        document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(btn.dataset.tab).classList.add('active');
      });
    });

    document.getElementById('rank').addEventListener('change',calculate);
    document.querySelectorAll('.qty').forEach(input=>{
      input.addEventListener('input',calculate);
    });

    document.getElementById('orderDate').textContent = new Date().toISOString().slice(0,10);
    calculate();
  </script>
</body>
</html>
